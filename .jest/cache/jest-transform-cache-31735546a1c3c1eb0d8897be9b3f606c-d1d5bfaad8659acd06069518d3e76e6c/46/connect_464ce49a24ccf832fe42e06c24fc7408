f5467d8d4569e8da2678daf2a3bc90ce
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault")["default"];

exports.__esModule = true;
exports.createConnect = createConnect;
exports["default"] = void 0;

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _objectWithoutPropertiesLoose2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutPropertiesLoose"));

var _connectAdvanced = _interopRequireDefault(require("../components/connectAdvanced"));

var _shallowEqual = _interopRequireDefault(require("../utils/shallowEqual"));

var _mapDispatchToProps = _interopRequireDefault(require("./mapDispatchToProps"));

var _mapStateToProps = _interopRequireDefault(require("./mapStateToProps"));

var _mergeProps = _interopRequireDefault(require("./mergeProps"));

var _selectorFactory = _interopRequireDefault(require("./selectorFactory"));

var _excluded = ["pure", "areStatesEqual", "areOwnPropsEqual", "areStatePropsEqual", "areMergedPropsEqual"];

function match(arg, factories, name) {
  for (var i = factories.length - 1; i >= 0; i--) {
    var result = factories[i](arg);
    if (result) return result;
  }

  return function (dispatch, options) {
    throw new Error("Invalid value of type " + typeof arg + " for " + name + " argument when connecting component " + options.wrappedComponentName + ".");
  };
}

function strictEqual(a, b) {
  return a === b;
}

function createConnect(_temp) {
  var _ref = _temp === void 0 ? {} : _temp,
      _ref$connectHOC = _ref.connectHOC,
      connectHOC = _ref$connectHOC === void 0 ? _connectAdvanced["default"] : _ref$connectHOC,
      _ref$mapStateToPropsF = _ref.mapStateToPropsFactories,
      mapStateToPropsFactories = _ref$mapStateToPropsF === void 0 ? _mapStateToProps["default"] : _ref$mapStateToPropsF,
      _ref$mapDispatchToPro = _ref.mapDispatchToPropsFactories,
      mapDispatchToPropsFactories = _ref$mapDispatchToPro === void 0 ? _mapDispatchToProps["default"] : _ref$mapDispatchToPro,
      _ref$mergePropsFactor = _ref.mergePropsFactories,
      mergePropsFactories = _ref$mergePropsFactor === void 0 ? _mergeProps["default"] : _ref$mergePropsFactor,
      _ref$selectorFactory = _ref.selectorFactory,
      selectorFactory = _ref$selectorFactory === void 0 ? _selectorFactory["default"] : _ref$selectorFactory;

  return function connect(mapStateToProps, mapDispatchToProps, mergeProps, _ref2) {
    if (_ref2 === void 0) {
      _ref2 = {};
    }

    var _ref3 = _ref2,
        _ref3$pure = _ref3.pure,
        pure = _ref3$pure === void 0 ? true : _ref3$pure,
        _ref3$areStatesEqual = _ref3.areStatesEqual,
        areStatesEqual = _ref3$areStatesEqual === void 0 ? strictEqual : _ref3$areStatesEqual,
        _ref3$areOwnPropsEqua = _ref3.areOwnPropsEqual,
        areOwnPropsEqual = _ref3$areOwnPropsEqua === void 0 ? _shallowEqual["default"] : _ref3$areOwnPropsEqua,
        _ref3$areStatePropsEq = _ref3.areStatePropsEqual,
        areStatePropsEqual = _ref3$areStatePropsEq === void 0 ? _shallowEqual["default"] : _ref3$areStatePropsEq,
        _ref3$areMergedPropsE = _ref3.areMergedPropsEqual,
        areMergedPropsEqual = _ref3$areMergedPropsE === void 0 ? _shallowEqual["default"] : _ref3$areMergedPropsE,
        extraOptions = (0, _objectWithoutPropertiesLoose2["default"])(_ref3, _excluded);
    var initMapStateToProps = match(mapStateToProps, mapStateToPropsFactories, 'mapStateToProps');
    var initMapDispatchToProps = match(mapDispatchToProps, mapDispatchToPropsFactories, 'mapDispatchToProps');
    var initMergeProps = match(mergeProps, mergePropsFactories, 'mergeProps');
    return connectHOC(selectorFactory, (0, _extends2["default"])({
      methodName: 'connect',
      getDisplayName: function getDisplayName(name) {
        return "Connect(" + name + ")";
      },
      shouldHandleStateChanges: Boolean(mapStateToProps),
      initMapStateToProps: initMapStateToProps,
      initMapDispatchToProps: initMapDispatchToProps,
      initMergeProps: initMergeProps,
      pure: pure,
      areStatesEqual: areStatesEqual,
      areOwnPropsEqual: areOwnPropsEqual,
      areStatePropsEqual: areStatePropsEqual,
      areMergedPropsEqual: areMergedPropsEqual
    }, extraOptions));
  };
}

var _default = createConnect();

exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbm5lY3QuanMiXSwibmFtZXMiOlsiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJleHBvcnRzIiwiX19lc01vZHVsZSIsImNyZWF0ZUNvbm5lY3QiLCJfZXh0ZW5kczIiLCJfb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZTIiLCJfY29ubmVjdEFkdmFuY2VkIiwiX3NoYWxsb3dFcXVhbCIsIl9tYXBEaXNwYXRjaFRvUHJvcHMiLCJfbWFwU3RhdGVUb1Byb3BzIiwiX21lcmdlUHJvcHMiLCJfc2VsZWN0b3JGYWN0b3J5IiwiX2V4Y2x1ZGVkIiwibWF0Y2giLCJhcmciLCJmYWN0b3JpZXMiLCJuYW1lIiwiaSIsImxlbmd0aCIsInJlc3VsdCIsImRpc3BhdGNoIiwib3B0aW9ucyIsIkVycm9yIiwid3JhcHBlZENvbXBvbmVudE5hbWUiLCJzdHJpY3RFcXVhbCIsImEiLCJiIiwiX3RlbXAiLCJfcmVmIiwiX3JlZiRjb25uZWN0SE9DIiwiY29ubmVjdEhPQyIsIl9yZWYkbWFwU3RhdGVUb1Byb3BzRiIsIm1hcFN0YXRlVG9Qcm9wc0ZhY3RvcmllcyIsIl9yZWYkbWFwRGlzcGF0Y2hUb1BybyIsIm1hcERpc3BhdGNoVG9Qcm9wc0ZhY3RvcmllcyIsIl9yZWYkbWVyZ2VQcm9wc0ZhY3RvciIsIm1lcmdlUHJvcHNGYWN0b3JpZXMiLCJfcmVmJHNlbGVjdG9yRmFjdG9yeSIsInNlbGVjdG9yRmFjdG9yeSIsImNvbm5lY3QiLCJtYXBTdGF0ZVRvUHJvcHMiLCJtYXBEaXNwYXRjaFRvUHJvcHMiLCJtZXJnZVByb3BzIiwiX3JlZjIiLCJfcmVmMyIsIl9yZWYzJHB1cmUiLCJwdXJlIiwiX3JlZjMkYXJlU3RhdGVzRXF1YWwiLCJhcmVTdGF0ZXNFcXVhbCIsIl9yZWYzJGFyZU93blByb3BzRXF1YSIsImFyZU93blByb3BzRXF1YWwiLCJfcmVmMyRhcmVTdGF0ZVByb3BzRXEiLCJhcmVTdGF0ZVByb3BzRXF1YWwiLCJfcmVmMyRhcmVNZXJnZWRQcm9wc0UiLCJhcmVNZXJnZWRQcm9wc0VxdWFsIiwiZXh0cmFPcHRpb25zIiwiaW5pdE1hcFN0YXRlVG9Qcm9wcyIsImluaXRNYXBEaXNwYXRjaFRvUHJvcHMiLCJpbml0TWVyZ2VQcm9wcyIsIm1ldGhvZE5hbWUiLCJnZXREaXNwbGF5TmFtZSIsInNob3VsZEhhbmRsZVN0YXRlQ2hhbmdlcyIsIkJvb2xlYW4iLCJfZGVmYXVsdCJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUEsSUFBSUEsc0JBQXNCLEdBQUdDLE9BQU8sQ0FBQyw4Q0FBRCxDQUFQLENBQXdELFNBQXhELENBQTdCOztBQUVBQyxPQUFPLENBQUNDLFVBQVIsR0FBcUIsSUFBckI7QUFDQUQsT0FBTyxDQUFDRSxhQUFSLEdBQXdCQSxhQUF4QjtBQUNBRixPQUFPLENBQUMsU0FBRCxDQUFQLEdBQXFCLEtBQUssQ0FBMUI7O0FBRUEsSUFBSUcsU0FBUyxHQUFHTCxzQkFBc0IsQ0FBQ0MsT0FBTyxDQUFDLGdDQUFELENBQVIsQ0FBdEM7O0FBRUEsSUFBSUssOEJBQThCLEdBQUdOLHNCQUFzQixDQUFDQyxPQUFPLENBQUMscURBQUQsQ0FBUixDQUEzRDs7QUFFQSxJQUFJTSxnQkFBZ0IsR0FBR1Asc0JBQXNCLENBQUNDLE9BQU8saUNBQVIsQ0FBN0M7O0FBRUEsSUFBSU8sYUFBYSxHQUFHUixzQkFBc0IsQ0FBQ0MsT0FBTyx5QkFBUixDQUExQzs7QUFFQSxJQUFJUSxtQkFBbUIsR0FBR1Qsc0JBQXNCLENBQUNDLE9BQU8sd0JBQVIsQ0FBaEQ7O0FBRUEsSUFBSVMsZ0JBQWdCLEdBQUdWLHNCQUFzQixDQUFDQyxPQUFPLHFCQUFSLENBQTdDOztBQUVBLElBQUlVLFdBQVcsR0FBR1gsc0JBQXNCLENBQUNDLE9BQU8sZ0JBQVIsQ0FBeEM7O0FBRUEsSUFBSVcsZ0JBQWdCLEdBQUdaLHNCQUFzQixDQUFDQyxPQUFPLHFCQUFSLENBQTdDOztBQUVBLElBQUlZLFNBQVMsR0FBRyxDQUFDLE1BQUQsRUFBUyxnQkFBVCxFQUEyQixrQkFBM0IsRUFBK0Msb0JBQS9D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RUFBRUEsbUJBVnNDO0FBVzNEQyxNQUFBQSxzQkFBc0IsRUFBRUEsc0JBWG1DO0FBWTNEQyxNQUFBQSxjQUFjLEVBQUVBLGNBWjJDO0FBYTNEWixNQUFBQSxJQUFJLEVBQUVBLElBYnFEO0FBYzNERSxNQUFBQSxjQUFjLEVBQUVBLGNBZDJDO0FBZTNERSxNQUFBQSxnQkFBZ0IsRUFBRUEsZ0JBZnlDO0FBZ0IzREUsTUFBQUEsa0JBQWtCLEVBQUVBLGtCQWhCdUM7QUFpQjNERSxNQUFBQSxtQkFBbUIsRUFBRUE7QUFqQnNDLEtBQTFCLEVBa0JoQ0MsWUFsQmdDLENBQWxCLENBQWpCO0FBbUJELEdBdkNEO0FBd0NEOztBQUVELElBQUlRLFFBQVEsR0FBZ0I1RCxhQUFhLEVBQXpDOztBQUVBRixPQUFPLENBQUMsU0FBRCxDQUFQLEdBQXFCOEQsUUFBckIiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIilbXCJkZWZhdWx0XCJdO1xuXG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuZXhwb3J0cy5jcmVhdGVDb25uZWN0ID0gY3JlYXRlQ29ubmVjdDtcbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gdm9pZCAwO1xuXG52YXIgX2V4dGVuZHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9leHRlbmRzXCIpKTtcblxudmFyIF9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvb2JqZWN0V2l0aG91dFByb3BlcnRpZXNMb29zZVwiKSk7XG5cbnZhciBfY29ubmVjdEFkdmFuY2VkID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vY29tcG9uZW50cy9jb25uZWN0QWR2YW5jZWRcIikpO1xuXG52YXIgX3NoYWxsb3dFcXVhbCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL3V0aWxzL3NoYWxsb3dFcXVhbFwiKSk7XG5cbnZhciBfbWFwRGlzcGF0Y2hUb1Byb3BzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9tYXBEaXNwYXRjaFRvUHJvcHNcIikpO1xuXG52YXIgX21hcFN0YXRlVG9Qcm9wcyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vbWFwU3RhdGVUb1Byb3BzXCIpKTtcblxudmFyIF9tZXJnZVByb3BzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9tZXJnZVByb3BzXCIpKTtcblxudmFyIF9zZWxlY3RvckZhY3RvcnkgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL3NlbGVjdG9yRmFjdG9yeVwiKSk7XG5cbnZhciBfZXhjbHVkZWQgPSBbXCJwdXJlXCIsIFwiYXJlU3RhdGVzRXF1YWxcIiwgXCJhcmVPd25Qcm9wc0VxdWFsXCIsIFwiYXJlU3RhdGVQcm9wc0VxdWFsXCIsIFwiYXJlTWVyZ2VkUHJvcHNFcXVhbFwiXTtcblxuLypcbiAgY29ubmVjdCBpcyBhIGZhY2FkZSBvdmVyIGNvbm5lY3RBZHZhbmNlZC4gSXQgdHVybnMgaXRzIGFyZ3MgaW50byBhIGNvbXBhdGlibGVcbiAgc2VsZWN0b3JGYWN0b3J5LCB3aGljaCBoYXMgdGhlIHNpZ25hdHVyZTpcblxuICAgIChkaXNwYXRjaCwgb3B0aW9ucykgPT4gKG5leHRTdGF0ZSwgbmV4dE93blByb3BzKSA9PiBuZXh0RmluYWxQcm9wc1xuICBcbiAgY29ubmVjdCBwYXNzZXMgaXRzIGFyZ3MgdG8gY29ubmVjdEFkdmFuY2VkIGFzIG9wdGlvbnMsIHdoaWNoIHdpbGwgaW4gdHVybiBwYXNzIHRoZW0gdG9cbiAgc2VsZWN0b3JGYWN0b3J5IGVhY2ggdGltZSBhIENvbm5lY3QgY29tcG9uZW50IGluc3RhbmNlIGlzIGluc3RhbnRpYXRlZCBvciBob3QgcmVsb2FkZWQuXG5cbiAgc2VsZWN0b3JGYWN0b3J5IHJldHVybnMgYSBmaW5hbCBwcm9wcyBzZWxlY3RvciBmcm9tIGl0cyBtYXBTdGF0ZVRvUHJvcHMsXG4gIG1hcFN0YXRlVG9Qcm9wc0ZhY3RvcmllcywgbWFwRGlzcGF0Y2hUb1Byb3BzLCBtYXBEaXNwYXRjaFRvUHJvcHNGYWN0b3JpZXMsIG1lcmdlUHJvcHMsXG4gIG1lcmdlUHJvcHNGYWN0b3JpZXMsIGFuZCBwdXJlIGFyZ3MuXG5cbiAgVGhlIHJlc3VsdGluZyBmaW5hbCBwcm9wcyBzZWxlY3RvciBpcyBjYWxsZWQgYnkgdGhlIENvbm5lY3QgY29tcG9uZW50IGluc3RhbmNlIHdoZW5ldmVyXG4gIGl0IHJlY2VpdmVzIG5ldyBwcm9wcyBvciBzdG9yZSBzdGF0ZS5cbiAqL1xuZnVuY3Rpb24gbWF0Y2goYXJnLCBmYWN0b3JpZXMsIG5hbWUpIHtcbiAgZm9yICh2YXIgaSA9IGZhY3Rvcmllcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgIHZhciByZXN1bHQgPSBmYWN0b3JpZXNbaV0oYXJnKTtcbiAgICBpZiAocmVzdWx0KSByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgcmV0dXJuIGZ1bmN0aW9uIChkaXNwYXRjaCwgb3B0aW9ucykge1xuICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgdmFsdWUgb2YgdHlwZSBcIiArIHR5cGVvZiBhcmcgKyBcIiBmb3IgXCIgKyBuYW1lICsgXCIgYXJndW1lbnQgd2hlbiBjb25uZWN0aW5nIGNvbXBvbmVudCBcIiArIG9wdGlvbnMud3JhcHBlZENvbXBvbmVudE5hbWUgKyBcIi5cIik7XG4gIH07XG59XG5cbmZ1bmN0aW9uIHN0cmljdEVxdWFsKGEsIGIpIHtcbiAgcmV0dXJuIGEgPT09IGI7XG59IC8vIGNyZWF0ZUNvbm5lY3Qgd2l0aCBkZWZhdWx0IGFyZ3MgYnVpbGRzIHRoZSAnb2ZmaWNpYWwnIGNvbm5lY3QgYmVoYXZpb3IuIENhbGxpbmcgaXQgd2l0aFxuLy8gZGlmZmVyZW50IG9wdGlvbnMgb3BlbnMgdXAgc29tZSB0ZXN0aW5nIGFuZCBleHRlbnNpYmlsaXR5IHNjZW5hcmlvc1xuXG5cbmZ1bmN0aW9uIGNyZWF0ZUNvbm5lY3QoX3RlbXApIHtcbiAgdmFyIF9yZWYgPSBfdGVtcCA9PT0gdm9pZCAwID8ge30gOiBfdGVtcCxcbiAgICAgIF9yZWYkY29ubmVjdEhPQyA9IF9yZWYuY29ubmVjdEhPQyxcbiAgICAgIGNvbm5lY3RIT0MgPSBfcmVmJGNvbm5lY3RIT0MgPT09IHZvaWQgMCA/IF9jb25uZWN0QWR2YW5jZWRbXCJkZWZhdWx0XCJdIDogX3JlZiRjb25uZWN0SE9DLFxuICAgICAgX3JlZiRtYXBTdGF0ZVRvUHJvcHNGID0gX3JlZi5tYXBTdGF0ZVRvUHJvcHNGYWN0b3JpZXMsXG4gICAgICBtYXBTdGF0ZVRvUHJvcHNGYWN0b3JpZXMgPSBfcmVmJG1hcFN0YXRlVG9Qcm9wc0YgPT09IHZvaWQgMCA/IF9tYXBTdGF0ZVRvUHJvcHNbXCJkZWZhdWx0XCJdIDogX3JlZiRtYXBTdGF0ZVRvUHJvcHNGLFxuICAgICAgX3JlZiRtYXBEaXNwYXRjaFRvUHJvID0gX3JlZi5tYXBEaXNwYXRjaFRvUHJvcHNGYWN0b3JpZXMsXG4gICAgICBtYXBEaXNwYXRjaFRvUHJvcHNGYWN0b3JpZXMgPSBfcmVmJG1hcERpc3BhdGNoVG9Qcm8gPT09IHZvaWQgMCA/IF9tYXBEaXNwYXRjaFRvUHJvcHNbXCJkZWZhdWx0XCJdIDogX3JlZiRtYXBEaXNwYXRjaFRvUHJvLFxuICAgICAgX3JlZiRtZXJnZVByb3BzRmFjdG9yID0gX3JlZi5tZXJnZVByb3BzRmFjdG9yaWVzLFxuICAgICAgbWVyZ2VQcm9wc0ZhY3RvcmllcyA9IF9yZWYkbWVyZ2VQcm9wc0ZhY3RvciA9PT0gdm9pZCAwID8gX21lcmdlUHJvcHNbXCJkZWZhdWx0XCJdIDogX3JlZiRtZXJnZVByb3BzRmFjdG9yLFxuICAgICAgX3JlZiRzZWxlY3RvckZhY3RvcnkgPSBfcmVmLnNlbGVjdG9yRmFjdG9yeSxcbiAgICAgIHNlbGVjdG9yRmFjdG9yeSA9IF9yZWYkc2VsZWN0b3JGYWN0b3J5ID09PSB2b2lkIDAgPyBfc2VsZWN0b3JGYWN0b3J5W1wiZGVmYXVsdFwiXSA6IF9yZWYkc2VsZWN0b3JGYWN0b3J5O1xuXG4gIHJldHVybiBmdW5jdGlvbiBjb25uZWN0KG1hcFN0YXRlVG9Qcm9wcywgbWFwRGlzcGF0Y2hUb1Byb3BzLCBtZXJnZVByb3BzLCBfcmVmMikge1xuICAgIGlmIChfcmVmMiA9PT0gdm9pZCAwKSB7XG4gICAgICBfcmVmMiA9IHt9O1xuICAgIH1cblxuICAgIHZhciBfcmVmMyA9IF9yZWYyLFxuICAgICAgICBfcmVmMyRwdXJlID0gX3JlZjMucHVyZSxcbiAgICAgICAgcHVyZSA9IF9yZWYzJHB1cmUgPT09IHZvaWQgMCA/IHRydWUgOiBfcmVmMyRwdXJlLFxuICAgICAgICBfcmVmMyRhcmVTdGF0ZXNFcXVhbCA9IF9yZWYzLmFyZVN0YXRlc0VxdWFsLFxuICAgICAgICBhcmVTdGF0ZXNFcXVhbCA9IF9yZWYzJGFyZVN0YXRlc0VxdWFsID09PSB2b2lkIDAgPyBzdHJpY3RFcXVhbCA6IF9yZWYzJGFyZVN0YXRlc0VxdWFsLFxuICAgICAgICBfcmVmMyRhcmVPd25Qcm9wc0VxdWEgPSBfcmVmMy5hcmVPd25Qcm9wc0VxdWFsLFxuICAgICAgICBhcmVPd25Qcm9wc0VxdWFsID0gX3JlZjMkYXJlT3duUHJvcHNFcXVhID09PSB2b2lkIDAgPyBfc2hhbGxvd0VxdWFsW1wiZGVmYXVsdFwiXSA6IF9yZWYzJGFyZU93blByb3BzRXF1YSxcbiAgICAgICAgX3JlZjMkYXJlU3RhdGVQcm9wc0VxID0gX3JlZjMuYXJlU3RhdGVQcm9wc0VxdWFsLFxuICAgICAgICBhcmVTdGF0ZVByb3BzRXF1YWwgPSBfcmVmMyRhcmVTdGF0ZVByb3BzRXEgPT09IHZvaWQgMCA/IF9zaGFsbG93RXF1YWxbXCJkZWZhdWx0XCJdIDogX3JlZjMkYXJlU3RhdGVQcm9wc0VxLFxuICAgICAgICBfcmVmMyRhcmVNZXJnZWRQcm9wc0UgPSBfcmVmMy5hcmVNZXJnZWRQcm9wc0VxdWFsLFxuICAgICAgICBhcmVNZXJnZWRQcm9wc0VxdWFsID0gX3JlZjMkYXJlTWVyZ2VkUHJvcHNFID09PSB2b2lkIDAgPyBfc2hhbGxvd0VxdWFsW1wiZGVmYXVsdFwiXSA6IF9yZWYzJGFyZU1lcmdlZFByb3BzRSxcbiAgICAgICAgZXh0cmFPcHRpb25zID0gKDAsIF9vYmplY3RXaXRob3V0UHJvcGVydGllc0xvb3NlMltcImRlZmF1bHRcIl0pKF9yZWYzLCBfZXhjbHVkZWQpO1xuICAgIHZhciBpbml0TWFwU3RhdGVUb1Byb3BzID0gbWF0Y2gobWFwU3RhdGVUb1Byb3BzLCBtYXBTdGF0ZVRvUHJvcHNGYWN0b3JpZXMsICdtYXBTdGF0ZVRvUHJvcHMnKTtcbiAgICB2YXIgaW5pdE1hcERpc3BhdGNoVG9Qcm9wcyA9IG1hdGNoKG1hcERpc3BhdGNoVG9Qcm9wcywgbWFwRGlzcGF0Y2hUb1Byb3BzRmFjdG9yaWVzLCAnbWFwRGlzcGF0Y2hUb1Byb3BzJyk7XG4gICAgdmFyIGluaXRNZXJnZVByb3BzID0gbWF0Y2gobWVyZ2VQcm9wcywgbWVyZ2VQcm9wc0ZhY3RvcmllcywgJ21lcmdlUHJvcHMnKTtcbiAgICByZXR1cm4gY29ubmVjdEhPQyhzZWxlY3RvckZhY3RvcnksICgwLCBfZXh0ZW5kczJbXCJkZWZhdWx0XCJdKSh7XG4gICAgICAvLyB1c2VkIGluIGVycm9yIG1lc3NhZ2VzXG4gICAgICBtZXRob2ROYW1lOiAnY29ubmVjdCcsXG4gICAgICAvLyB1c2VkIHRvIGNvbXB1dGUgQ29ubmVjdCdzIGRpc3BsYXlOYW1lIGZyb20gdGhlIHdyYXBwZWQgY29tcG9uZW50J3MgZGlzcGxheU5hbWUuXG4gICAgICBnZXREaXNwbGF5TmFtZTogZnVuY3Rpb24gZ2V0RGlzcGxheU5hbWUobmFtZSkge1xuICAgICAgICByZXR1cm4gXCJDb25uZWN0KFwiICsgbmFtZSArIFwiKVwiO1xuICAgICAgfSxcbiAgICAgIC8vIGlmIG1hcFN0YXRlVG9Qcm9wcyBpcyBmYWxzeSwgdGhlIENvbm5lY3QgY29tcG9uZW50IGRvZXNuJ3Qgc3Vic2NyaWJlIHRvIHN0b3JlIHN0YXRlIGNoYW5nZXNcbiAgICAgIHNob3VsZEhhbmRsZVN0YXRlQ2hhbmdlczogQm9vbGVhbihtYXBTdGF0ZVRvUHJvcHMpLFxuICAgICAgLy8gcGFzc2VkIHRocm91Z2ggdG8gc2VsZWN0b3JGYWN0b3J5XG4gICAgICBpbml0TWFwU3RhdGVUb1Byb3BzOiBpbml0TWFwU3RhdGVUb1Byb3BzLFxuICAgICAgaW5pdE1hcERpc3BhdGNoVG9Qcm9wczogaW5pdE1hcERpc3BhdGNoVG9Qcm9wcyxcbiAgICAgIGluaXRNZXJnZVByb3BzOiBpbml0TWVyZ2VQcm9wcyxcbiAgICAgIHB1cmU6IHB1cmUsXG4gICAgICBhcmVTdGF0ZXNFcXVhbDogYXJlU3RhdGVzRXF1YWwsXG4gICAgICBhcmVPd25Qcm9wc0VxdWFsOiBhcmVPd25Qcm9wc0VxdWFsLFxuICAgICAgYXJlU3RhdGVQcm9wc0VxdWFsOiBhcmVTdGF0ZVByb3BzRXF1YWwsXG4gICAgICBhcmVNZXJnZWRQcm9wc0VxdWFsOiBhcmVNZXJnZWRQcm9wc0VxdWFsXG4gICAgfSwgZXh0cmFPcHRpb25zKSk7XG4gIH07XG59XG5cbnZhciBfZGVmYXVsdCA9IC8qI19fUFVSRV9fKi9jcmVhdGVDb25uZWN0KCk7XG5cbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gX2RlZmF1bHQ7Il19