1d7164d0d9ad7b9713c715e0ef5e86bc
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _wrapNativeSuper2 = _interopRequireDefault(require("@babel/runtime/helpers/wrapNativeSuper"));

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }

function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }

var SyntheticError = function (_Error) {
  (0, _inherits2.default)(SyntheticError, _Error);

  var _super = _createSuper(SyntheticError);

  function SyntheticError() {
    var _this;

    (0, _classCallCheck2.default)(this, SyntheticError);

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    _this = _super.call.apply(_super, [this].concat(args));
    _this.name = '';
    return _this;
  }

  return (0, _createClass2.default)(SyntheticError);
}((0, _wrapNativeSuper2.default)(Error));

var userExceptionDecorator;
var inUserExceptionDecorator = false;

function unstable_setExceptionDecorator(exceptionDecorator) {
  userExceptionDecorator = exceptionDecorator;
}

function preprocessException(data) {
  if (userExceptionDecorator && !inUserExceptionDecorator) {
    inUserExceptionDecorator = true;

    try {
      return userExceptionDecorator(data);
    } catch (_unused) {} finally {
      inUserExceptionDecorator = false;
    }
  }

  return data;
}

var exceptionID = 0;

function reportException(e, isFatal, reportToConsole) {
  var NativeExceptionsManager = require("./NativeExceptionsManager").default;

  if (NativeExceptionsManager) {
    var parseErrorStack = require("./Devtools/parseErrorStack");

    var stack = parseErrorStack(e == null ? void 0 : e.stack);
    var currentExceptionID = ++exceptionID;
    var originalMessage = e.message || '';
    var message = originalMessage;

    if (e.componentStack != null) {
      message += "\n\nThis error is located at:" + e.componentStack;
    }

    var namePrefix = e.name == null || e.name === '' ? '' : e.name + ": ";

    if (!message.startsWith(namePrefix)) {
      message = namePrefix + message;
    }

    message = e.jsEngine == null ? message : message + ", js engine: " + e.jsEngine;
    var isHandledByLogBox = e.forceRedbox !== true && !global.RN$Bridgeless && !global.RN$Express;
    var data = preprocessException({
      message: message,
      originalMessage: message === originalMessage ? null : originalMessage,
      name: e.name == null || e.name === '' ? null : e.name,
      componentStack: typeof e.componentStack === 'string' ? e.componentStack : null,
      stack: stack,
      id: currentExceptionID,
      isFatal: isFatal,
      extraData: {
        jsEngine: e.jsEngine,
        rawStack: e.stack,
        suppressRedBox: isHandledByLogBox
      }
    });

    if (reportToConsole) {
      console.error(data.message);
    }

    if (__DEV__ && isHandledByLogBox) {
      var LogBoxData = require("../LogBox/Data/LogBoxData");

      LogBoxData.addException(_objectSpread(_objectSpread({}, data), {}, {
        isComponentError: !!e.isComponentError
      }));
    }

    NativeExceptionsManager.reportException(data);

    if (__DEV__ && !global.RN$Express) {
      if (e.preventSymbolication === true) {
        return;
      }

      var symbolicateStackTrace = require("./Devtools/symbolicateStackTrace");

      symbolicateStackTrace(stack).then(function (_ref) {
        var prettyStack = _ref.stack;

        if (prettyStack) {
          NativeExceptionsManager.updateExceptionMessage(data.message, prettyStack, currentExceptionID);
        } else {
          throw new Error('The stack is null');
        }
      }).catch(function (error) {
        console.log('Unable to symbolicate stack trace: ' + error.message);
      });
    }
  } else if (reportToConsole) {
    console.error(e);
  }
}

var inExceptionHandler = false;

function handleException(e, isFatal) {
  var error;

  if (e instanceof Error) {
    error = e;
  } else {
    error = new SyntheticError(e);
  }

  try {
    inExceptionHandler = true;
    reportException(error, isFatal, true);
  } finally {
    inExceptionHandler = false;
  }
}

function reactConsoleErrorHandler() {
  console._errorOriginal.apply(console, arguments);

  if (!console.reportErrorsAsExceptions) {
    return;
  }

  if (inExceptionHandler) {
    return;
  }

  if (arguments[0] && arguments[0].stack) {
    reportException(arguments[0], false, false);
  } else {
    var stringifySafe = require("../Utilities/stringifySafe").default;

    var str = Array.prototype.map.call(arguments, function (value) {
      return typeof value === 'string' ? value : stringifySafe(value);
    }).join(' ');

    if (str.slice(0, 9) === 'Warning: ') {
      return;
    }

    var _error = new SyntheticError(str);

    _error.name = 'console.error';
    reportException(_error, false, false);
  }
}

function installConsoleErrorReporter() {
  if (console._errorOriginal) {
    return;
  }

  console._errorOriginal = console.error.bind(console);
  console.error = reactConsoleErrorHandler;

  if (console.reportErrorsAsExceptions === undefined) {
    console.reportErrorsAsExceptions = true;
  }
}

module.exports = {
  handleException: handleException,
  installConsoleErrorReporter: installConsoleErrorReporter,
  SyntheticError: SyntheticError,
  unstable_setExceptionDecorator: unstable_setExceptionDecorator
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkV4Y2VwdGlvbnNNYW5hZ2VyLmpzIl0sIm5hbWVzIjpbIlN5bnRoZXRpY0Vycm9yIiwibmFtZSIsIkVycm9yIiwidXNlckV4Y2VwdGlvbkRlY29yYXRvciIsImluVXNlckV4Y2VwdGlvbkRlY29yYXRvciIsInVuc3RhYmxlX3NldEV4Y2VwdGlvbkRlY29yYXRvciIsImV4Y2VwdGlvbkRlY29yYXRvciIsInByZXByb2Nlc3NFeGNlcHRpb24iLCJkYXRhIiwiZXhjZXB0aW9uSUQiLCJyZXBvcnRFeGNlcHRpb24iLCJlIiwiaXNGYXRhbCIsInJlcG9ydFRvQ29uc29sZSIsIk5hdGl2ZUV4Y2VwdGlvbnNNYW5hZ2VyIiwicmVxdWlyZSIsImRlZmF1bHQiLCJwYXJzZUVycm9yU3RhY2siLCJzdGFjayIsImN1cnJlbnRFeGNlcHRpb25JRCIsIm9yaWdpbmFsTWVzc2FnZSIsIm1lc3NhZ2UiLCJjb21wb25lbnRTdGFjayIsIm5hbWVQcmVmaXgiLCJzdGFydHNXaXRoIiwianNFbmdpbmUiLCJpc0hhbmRsZWRCeUxvZ0JveCIsImZvcmNlUmVkYm94IiwiZ2xvYmFsIiwiUk4kQnJpZGdlbGVzcyIsIlJOJEV4cHJlc3MiLCJpZCIsImV4dHJhRGF0YSIsInJhd1N0YWNrIiwic3VwcHJlc3NSZWRCb3giLCJjb25zb2xlIiwiZXJyb3IiLCJfX0RFVl9fIiwiTG9nQm94RGF0YSIsImFkZEV4Y2VwdGlvbiIsImlzQ29tcG9uZW50RXJyb3IiLCJwcmV2ZW50U3ltYm9saWNhdGlvbiIsInN5bWJvbGljYXRlU3RhY2tUcmFjZSIsInRoZW4iLCJwcmV0dHlTdGFjayIsInVwZGF0ZUV4Y2VwdGlvbk1lc3NhZ2UiLCJjYXRjaCIsImxvZyIsImluRXhjZXB0aW9uSGFuZGxlciIsImhhbmRsZUV4Y2VwdGlvbiIsInJlYWN0Q29uc29sZUVycm9ySGFuZGxlciIsIl9lcnJvck9yaWdpbmFsIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJyZXBvcnRFcnJvcnNBc0V4Y2VwdGlvbnMiLCJzdHJpbmdpZnlTYWZlIiwic3RyIiwiQXJyYXkiLCJwcm90b3R5cGUiLCJtYXAiLCJjYWxsIiwidmFsdWUiLCJqb2luIiwic2xpY2UiLCJpbnN0YWxsQ29uc29sZUVycm9yUmVwb3J0ZXIiLCJiaW5kIiwidW5kZWZpbmVkIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBVUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0lBS01BLGM7Ozs7Ozs7Ozs7Ozs7OztVQUNKQyxJLEdBQWUsRTs7Ozs7aUNBRFlDLEs7O0FBTTdCLElBQUlDLHNCQUFKO0FBQ0EsSUFBSUMsd0JBQXdCLEdBQUcsS0FBL0I7O0FBT0EsU0FBU0MsOEJBQVQsQ0FDRUMsa0JBREYsRUFFRTtBQUNBSCxFQUFBQSxzQkFBc0IsR0FBR0csa0JBQXpCO0FBQ0Q7O0FBRUQsU0FBU0MsbUJBQVQsQ0FBNkJDLElBQTdCLEVBQWlFO0FBQy9ELE1BQUlMLHNCQUFzQixJQUFJLENBQUNDLHdCQUEvQixFQUF5RDtBQUN2REEsSUFBQUEsd0JBQXdCLEdBQUcsSUFBM0I7O0FBQ0EsUUFBSTtBQUNGLGFBQU9ELHNCQUFzQixDQUFDSyxJQUFELENBQTdCO0FBQ0QsS0FGRCxDQUVFLGdCQUFNLENBRVAsQ0FKRCxTQUlVO0FBQ1JKLE1BQUFBLHdCQUF3QixHQUFHLEtBQTNCO0FBQ0Q7QUFDRjs7QUFDRCxTQUFPSSxJQUFQO0FBQ0Q7O0FBS0QsSUFBSUMsV0FBVyxHQUFHLENBQWxCOztBQUNBLFNBQVNDLGVBQVQsQ0FDRUMsQ0FERixFQUVFQyxPQUZGLEVBR0VDLGVBSEYsRUFJRTtBQUNBLE1BQU1DLHVCQUF1QixHQUFHQyxPQUFPLDZCQUFQLENBQXFDQyxPQUFyRTs7QUFDQSxNQUFJRix1QkFBSixFQUE2QjtBQUMzQixRQUFNRyxlQUFlLEdBQUdGLE9BQU8sOEJBQS9COztBQUNBLFFBQU1HLEtBQUssR0FBR0QsZUFBZSxDQUFDTixDQUFELG9CQUFDQSxDQUFDLENBQUVPLEtBQUosQ0FBN0I7QUFDQSxRQUFNQyxrQkFBa0IsR0FBRyxFQUFFVixXQUE3QjtB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R2xEL0IsSUFBQUEsT0FBTyxDQUFDbUIsd0JBQVIsR0FBbUMsSUFBbkM7QUFDRDtBQUNGOztBQUVEYSxNQUFNLENBQUNDLE9BQVAsR0FBaUI7QUFDZm5CLEVBQUFBLGVBQWUsRUFBZkEsZUFEZTtBQUVmZSxFQUFBQSwyQkFBMkIsRUFBM0JBLDJCQUZlO0FBR2ZoRSxFQUFBQSxjQUFjLEVBQWRBLGNBSGU7QUFJZkssRUFBQUEsOEJBQThCLEVBQTlCQTtBQUplLENBQWpCIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIEZhY2Vib29rLCBJbmMuIGFuZCBpdHMgYWZmaWxpYXRlcy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqXG4gKiBAZm9ybWF0XG4gKiBAZmxvdyBzdHJpY3QtbG9jYWxcbiAqL1xuXG4ndXNlIHN0cmljdCc7XG5cbmltcG9ydCB0eXBlIHtFeHRlbmRlZEVycm9yfSBmcm9tICcuL0RldnRvb2xzL3BhcnNlRXJyb3JTdGFjayc7XG5pbXBvcnQgdHlwZSB7RXhjZXB0aW9uRGF0YX0gZnJvbSAnLi9OYXRpdmVFeGNlcHRpb25zTWFuYWdlcic7XG5cbmNsYXNzIFN5bnRoZXRpY0Vycm9yIGV4dGVuZHMgRXJyb3Ige1xuICBuYW1lOiBzdHJpbmcgPSAnJztcbn1cblxudHlwZSBFeGNlcHRpb25EZWNvcmF0b3IgPSBFeGNlcHRpb25EYXRhID0+IEV4Y2VwdGlvbkRhdGE7XG5cbmxldCB1c2VyRXhjZXB0aW9uRGVjb3JhdG9yOiA/RXhjZXB0aW9uRGVjb3JhdG9yO1xubGV0IGluVXNlckV4Y2VwdGlvbkRlY29yYXRvciA9IGZhbHNlO1xuXG4vKipcbiAqIEFsbG93cyB0aGUgYXBwIHRvIGFkZCBpbmZvcm1hdGlvbiB0byB0aGUgZXhjZXB0aW9uIHJlcG9ydCBiZWZvcmUgaXQgaXMgc2VudFxuICogdG8gbmF0aXZlLiBUaGlzIEFQSSBpcyBub3QgZmluYWwuXG4gKi9cblxuZnVuY3Rpb24gdW5zdGFibGVfc2V0RXhjZXB0aW9uRGVjb3JhdG9yKFxuICBleGNlcHRpb25EZWNvcmF0b3I6ID9FeGNlcHRpb25EZWNvcmF0b3IsXG4pIHtcbiAgdXNlckV4Y2VwdGlvbkRlY29yYXRvciA9IGV4Y2VwdGlvbkRlY29yYXRvcjtcbn1cblxuZnVuY3Rpb24gcHJlcHJvY2Vzc0V4Y2VwdGlvbihkYXRhOiBFeGNlcHRpb25EYXRhKTogRXhjZXB0aW9uRGF0YSB7XG4gIGlmICh1c2VyRXhjZXB0aW9uRGVjb3JhdG9yICYmICFpblVzZXJFeGNlcHRpb25EZWNvcmF0b3IpIHtcbiAgICBpblVzZXJFeGNlcHRpb25EZWNvcmF0b3IgPSB0cnVlO1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gdXNlckV4Y2VwdGlvbkRlY29yYXRvcihkYXRhKTtcbiAgICB9IGNhdGNoIHtcbiAgICAgIC8vIEZhbGwgdGhyb3VnaFxuICAgIH0gZmluYWxseSB7XG4gICAgICBpblVzZXJFeGNlcHRpb25EZWNvcmF0b3IgPSBmYWxzZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGRhdGE7XG59XG5cbi8qKlxuICogSGFuZGxlcyB0aGUgZGV2ZWxvcGVyLXZpc2libGUgYXNwZWN0IG9mIGVycm9ycyBhbmQgZXhjZXB0aW9uc1xuICovXG5sZXQgZXhjZXB0aW9uSUQgPSAwO1xuZnVuY3Rpb24gcmVwb3J0RXhjZXB0aW9uKFxuICBlOiBFeHRlbmRlZEVycm9yLFxuICBpc0ZhdGFsOiBib29sZWFuLFxuICByZXBvcnRUb0NvbnNvbGU6IGJvb2xlYW4sIC8vIG9ubHkgdHJ1ZSB3aGVuIGNvbWluZyBmcm9tIGhhbmRsZUV4Y2VwdGlvbjsgdGhlIGVycm9yIGhhcyBub3QgeWV0IGJlZW4gbG9nZ2VkXG4pIHtcbiAgY29uc3QgTmF0aXZlRXhjZXB0aW9uc01hbmFnZXIgPSByZXF1aXJlKCcuL05hdGl2ZUV4Y2VwdGlvbnNNYW5hZ2VyJykuZGVmYXVsdDtcbiAgaWYgKE5hdGl2ZUV4Y2VwdGlvbnNNYW5hZ2VyKSB7XG4gICAgY29uc3QgcGFyc2VFcnJvclN0YWNrID0gcmVxdWlyZSgnLi9EZXZ0b29scy9wYXJzZUVycm9yU3RhY2snKTtcbiAgICBjb25zdCBzdGFjayA9IHBhcnNlRXJyb3JTdGFjayhlPy5zdGFjayk7XG4gICAgY29uc3QgY3VycmVudEV4Y2VwdGlvbklEID0gKytleGNlcHRpb25JRDtcbiAgICBjb25zdCBvcmlnaW5hbE1lc3NhZ2UgPSBlLm1lc3NhZ2UgfHwgJyc7XG4gICAgbGV0IG1lc3NhZ2UgPSBvcmlnaW5hbE1lc3NhZ2U7XG4gICAgaWYgKGUuY29tcG9uZW50U3RhY2sgIT0gbnVsbCkge1xuICAgICAgbWVzc2FnZSArPSBgXFxuXFxuVGhpcyBlcnJvciBpcyBsb2NhdGVkIGF0OiR7ZS5jb21wb25lbnRTdGFja31gO1xuICAgIH1cbiAgICBjb25zdCBuYW1lUHJlZml4ID0gZS5uYW1lID09IG51bGwgfHwgZS5uYW1lID09PSAnJyA/ICcnIDogYCR7ZS5uYW1lfTogYDtcblxuICAgIGlmICghbWVzc2FnZS5zdGFydHNXaXRoKG5hbWVQcmVmaXgpKSB7XG4gICAgICBtZXNzYWdlID0gbmFtZVByZWZpeCArIG1lc3NhZ2U7XG4gICAgfVxuXG4gICAgbWVzc2FnZSA9XG4gICAgICBlLmpzRW5naW5lID09IG51bGwgPyBtZXNzYWdlIDogYCR7bWVzc2FnZX0sIGpzIGVuZ2luZTogJHtlLmpzRW5naW5lfWA7XG5cbiAgICBjb25zdCBpc0hhbmRsZWRCeUxvZ0JveCA9XG4gICAgICBlLmZvcmNlUmVkYm94ICE9PSB0cnVlICYmICFnbG9iYWwuUk4kQnJpZGdlbGVzcyAmJiAhZ2xvYmFsLlJOJEV4cHJlc3M7XG5cbiAgICBjb25zdCBkYXRhID0gcHJlcHJvY2Vzc0V4Y2VwdGlvbih7XG4gICAgICBtZXNzYWdlLFxuICAgICAgb3JpZ2luYWxNZXNzYWdlOiBtZXNzYWdlID09PSBvcmlnaW5hbE1lc3NhZ2UgPyBudWxsIDogb3JpZ2luYWxNZXNzYWdlLFxuICAgICAgbmFtZTogZS5uYW1lID09IG51bGwgfHwgZS5uYW1lID09PSAnJyA/IG51bGwgOiBlLm5hbWUsXG4gICAgICBjb21wb25lbnRTdGFjazpcbiAgICAgICAgdHlwZW9mIGUuY29tcG9uZW50U3RhY2sgPT09ICdzdHJpbmcnID8gZS5jb21wb25lbnRTdGFjayA6IG51bGwsXG4gICAgICBzdGFjayxcbiAgICAgIGlkOiBjdXJyZW50RXhjZXB0aW9uSUQsXG4gICAgICBpc0ZhdGFsLFxuICAgICAgZXh0cmFEYXRhOiB7XG4gICAgICAgIGpzRW5naW5lOiBlLmpzRW5naW5lLFxuICAgICAgICByYXdTdGFjazogZS5zdGFjayxcblxuICAgICAgICAvLyBIYWNrIHRvIGhpZGUgbmF0aXZlIHJlZGJveGVzIHdoZW4gaW4gdGhlIExvZ0JveCBleHBlcmltZW50LlxuICAgICAgICAvLyBUaGlzIGlzIGludGVudGlvbmFsbHkgdW50eXBlZCBhbmQgc3R1ZmZlZCBoZXJlLCBiZWNhdXNlIGl0IGlzIHRlbXBvcmFyeS5cbiAgICAgICAgc3VwcHJlc3NSZWRCb3g6IGlzSGFuZGxlZEJ5TG9nQm94LFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIGlmIChyZXBvcnRUb0NvbnNvbGUpIHtcbiAgICAgIC8vIHdlIGZlZWQgYmFjayBpbnRvIGNvbnNvbGUuZXJyb3IsIHRvIG1ha2Ugc3VyZSBhbnkgbWV0aG9kcyB0aGF0IGFyZVxuICAgICAgLy8gbW9ua2V5IHBhdGNoZWQgb24gdG9wIG9mIGNvbnNvbGUuZXJyb3IgYXJlIGNhbGxlZCB3aGVuIGNvbWluZyBmcm9tXG4gICAgICAvLyBoYW5kbGVFeGNlcHRpb25cbiAgICAgIGNvbnNvbGUuZXJyb3IoZGF0YS5tZXNzYWdlKTtcbiAgICB9XG5cbiAgICBpZiAoX19ERVZfXyAmJiBpc0hhbmRsZWRCeUxvZ0JveCkge1xuICAgICAgY29uc3QgTG9nQm94RGF0YSA9IHJlcXVpcmUoJy4uL0xvZ0JveC9EYXRhL0xvZ0JveERhdGEnKTtcbiAgICAgIExvZ0JveERhdGEuYWRkRXhjZXB0aW9uKHtcbiAgICAgICAgLi4uZGF0YSxcbiAgICAgICAgaXNDb21wb25lbnRFcnJvcjogISFlLmlzQ29tcG9uZW50RXJyb3IsXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBOYXRpdmVFeGNlcHRpb25zTWFuYWdlci5yZXBvcnRFeGNlcHRpb24oZGF0YSk7XG5cbiAgICBpZiAoX19ERVZfXyAmJiAhZ2xvYmFsLlJOJEV4cHJlc3MpIHtcbiAgICAgIGlmIChlLnByZXZlbnRTeW1ib2xpY2F0aW9uID09PSB0cnVlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHN5bWJvbGljYXRlU3RhY2tUcmFjZSA9IHJlcXVpcmUoJy4vRGV2dG9vbHMvc3ltYm9saWNhdGVTdGFja1RyYWNlJyk7XG4gICAgICBzeW1ib2xpY2F0ZVN0YWNrVHJhY2Uoc3RhY2spXG4gICAgICAgIC50aGVuKCh7c3RhY2s6IHByZXR0eVN0YWNrfSkgPT4ge1xuICAgICAgICAgIGlmIChwcmV0dHlTdGFjaykge1xuICAgICAgICAgICAgTmF0aXZlRXhjZXB0aW9uc01hbmFnZXIudXBkYXRlRXhjZXB0aW9uTWVzc2FnZShcbiAgICAgICAgICAgICAgZGF0YS5tZXNzYWdlLFxuICAgICAgICAgICAgICBwcmV0dHlTdGFjayxcbiAgICAgICAgICAgICAgY3VycmVudEV4Y2VwdGlvbklELFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGUgc3RhY2sgaXMgbnVsbCcpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKGVycm9yID0+IHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnVW5hYmxlIHRvIHN5bWJvbGljYXRlIHN0YWNrIHRyYWNlOiAnICsgZXJyb3IubWVzc2FnZSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgfSBlbHNlIGlmIChyZXBvcnRUb0NvbnNvbGUpIHtcbiAgICAvLyB3ZSBmZWVkIGJhY2sgaW50byBjb25zb2xlLmVycm9yLCB0byBtYWtlIHN1cmUgYW55IG1ldGhvZHMgdGhhdCBhcmVcbiAgICAvLyBtb25rZXkgcGF0Y2hlZCBvbiB0b3Agb2YgY29uc29sZS5lcnJvciBhcmUgY2FsbGVkIHdoZW4gY29taW5nIGZyb21cbiAgICAvLyBoYW5kbGVFeGNlcHRpb25cbiAgICBjb25zb2xlLmVycm9yKGUpO1xuICB9XG59XG5cbmRlY2xhcmUgdmFyIGNvbnNvbGU6IHR5cGVvZiBjb25zb2xlICYge1xuICBfZXJyb3JPcmlnaW5hbDogdHlwZW9mIGNvbnNvbGUuZXJyb3IsXG4gIHJlcG9ydEVycm9yc0FzRXhjZXB0aW9uczogYm9vbGVhbixcbiAgLi4uXG59O1xuXG4vLyBJZiB3ZSB0cmlnZ2VyIGNvbnNvbGUuZXJyb3IgX2Zyb21fIGhhbmRsZUV4Y2VwdGlvbixcbi8vIHdlIGRvIHdhbnQgdG8gbWFrZSBzdXJlIHRoYXQgY29uc29sZS5lcnJvciBkb2Vzbid0IHRyaWdnZXIgZXJyb3IgcmVwb3J0aW5nIGFnYWluXG5sZXQgaW5FeGNlcHRpb25IYW5kbGVyID0gZmFsc2U7XG5cbi8qKlxuICogTG9ncyBleGNlcHRpb25zIHRvIHRoZSAobmF0aXZlKSBjb25zb2xlIGFuZCBkaXNwbGF5cyB0aGVtXG4gKi9cbmZ1bmN0aW9uIGhhbmRsZUV4Y2VwdGlvbihlOiBtaXhlZCwgaXNGYXRhbDogYm9vbGVhbikge1xuICBsZXQgZXJyb3I6IEVycm9yO1xuICBpZiAoZSBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgZXJyb3IgPSBlO1xuICB9IGVsc2Uge1xuICAgIC8vIFdvcmthcm91bmQgZm9yIHJlcG9ydGluZyBlcnJvcnMgY2F1c2VkIGJ5IGB0aHJvdyAnc29tZSBzdHJpbmcnYFxuICAgIC8vIFVuZm9ydHVuYXRlbHkgdGhlcmUgaXMgbm8gd2F5IHRvIGZpZ3VyZSBvdXQgdGhlIHN0YWNrdHJhY2UgaW4gdGhpc1xuICAgIC8vIGNhc2UsIHNvIGlmIHlvdSBlbmRlZCB1cCBoZXJlIHRyeWluZyB0byB0cmFjZSBhbiBlcnJvciwgbG9vayBmb3JcbiAgICAvLyBgdGhyb3cgJzxlcnJvciBtZXNzYWdlPidgIHNvbWV3aGVyZSBpbiB5b3VyIGNvZGViYXNlLlxuICAgIGVycm9yID0gbmV3IFN5bnRoZXRpY0Vycm9yKGUpO1xuICB9XG4gIHRyeSB7XG4gICAgaW5FeGNlcHRpb25IYW5kbGVyID0gdHJ1ZTtcbiAgICByZXBvcnRFeGNlcHRpb24oZXJyb3IsIGlzRmF0YWwsIC8qcmVwb3J0VG9Db25zb2xlKi8gdHJ1ZSk7XG4gIH0gZmluYWxseSB7XG4gICAgaW5FeGNlcHRpb25IYW5kbGVyID0gZmFsc2U7XG4gIH1cbn1cblxuZnVuY3Rpb24gcmVhY3RDb25zb2xlRXJyb3JIYW5kbGVyKCkge1xuICAvLyBidWJibGUgdXAgdG8gYW55IG9yaWdpbmFsIGhhbmRsZXJzXG4gIGNvbnNvbGUuX2Vycm9yT3JpZ2luYWwuYXBwbHkoY29uc29sZSwgYXJndW1lbnRzKTtcbiAgaWYgKCFjb25zb2xlLnJlcG9ydEVycm9yc0FzRXhjZXB0aW9ucykge1xuICAgIHJldHVybjtcbiAgfVxuICBpZiAoaW5FeGNlcHRpb25IYW5kbGVyKSB7XG4gICAgLy8gVGhlIGZ1bmRhbWVudGFsIHRyaWNrIGhlcmUgaXMgdGhhdCBhcmUgbXVsdGlwbGUgZW50cnkgcG9pbnQgdG8gbG9nZ2luZyBlcnJvcnM6XG4gICAgLy8gKHNlZSBEMTk3NDMwNzUgZm9yIG1vcmUgYmFja2dyb3VuZClcbiAgICAvL1xuICAgIC8vIDEuIEFuIHVuY2F1Z2h0IGV4Y2VwdGlvbiBiZWluZyBjYXVnaHQgYnkgdGhlIGdsb2JhbCBoYW5kbGVyXG4gICAgLy8gMi4gQW4gZXJyb3IgYmVpbmcgbG9nZ2VkIHRocm93IGNvbnNvbGUuZXJyb3JcbiAgICAvL1xuICAgIC8vIEhvd2V2ZXIsIGNvbnNvbGUuZXJyb3IgaXMgbW9ua2V5IHBhdGNoZWQgbXVsdGlwbGUgdGltZXM6IGJ5IHRoaXMgbW9kdWxlLCBhbmQgYnkgdGhlXG4gICAgLy8gRGV2VG9vbHMgc2V0dXAgdGhhdCBzZW5kcyBtZXNzYWdlcyB0byBNZXRyby5cbiAgICAvLyBUaGUgcGF0Y2hpbmcgb3JkZXIgY2Fubm90IGJlIHJlbGllZCB1cG9uLlxuICAgIC8vXG4gICAgLy8gU28sIHNvbWUgc2NlbmFyaW9zIHRoYXQgYXJlIGhhbmRsZWQgYnkgdGhpcyBmbGFnOlxuICAgIC8vXG4gICAgLy8gTG9nZ2luZyBhbiBlcnJvcjpcbiAgICAvLyAxLiBjb25zb2xlLmVycm9yIGNhbGxlZCBmcm9tIHVzZXIgY29kZVxuICAgIC8vIDIuIChwb3NzaWJseSkgYXJyaXZlcyBfZmlyc3RfIGF0IERldlRvb2wgaGFuZGxlciwgc2VuZCB0byBNZXRyb1xuICAgIC8vIDMuIEJ1YmJsZXMgdG8gaGVyZVxuICAgIC8vIDQuIGdvZXMgaW50byByZXBvcnQgRXhjZXB0aW9uLlxuICAgIC8vIDUuIHNob3VsZCBub3QgdHJpZ2dlciBjb25zb2xlLmVycm9yIGFnYWluLCB0byBhdm9pZCBsb29waW5nIC8gbG9nZ2luZyB0d2ljZVxuICAgIC8vIDYuIHNob3VsZCBzdGlsbCBidWJibGUgdXAgdG8gb3JpZ2luYWwgY29uc29sZVxuICAgIC8vICAgICh3aGljaCBtaWdodCBlaXRoZXIgYmUgY29uc29sZS5sb2csIG9yIHRoZSBEZXZUb29scyBoYW5kbGVyIGluIGNhc2UgaXQgcGF0Y2hlZCBfZWFybGllcl8gYW5kICgyKSBkaWRuJ3QgaGFwcGVuKVxuICAgIC8vXG4gICAgLy8gVGhyb3dpbmcgYW4gdW5jYXVnaHQgZXhjZXB0aW9uOlxuICAgIC8vIDEuIGV4Y2VwdGlvbiB0aHJvd25cbiAgICAvLyAyLiBwaWNrZWQgdXAgYnkgaGFuZGxlRXhjZXB0aW9uXG4gICAgLy8gMy4gc2hvdWxkIGJlIHNlbmQgdG8gY29uc29sZS5lcnJvciAobm90IGNvbnNvbGUuX2Vycm9yT3JpZ2luYWwsIGFzIERldlRvb2xzIG1pZ2h0IGhhdmUgcGF0Y2hlZCBfbGF0ZXJfIGFuZCBpdCBuZWVkcyB0byBzZW5kIGl0IHRvIE1ldHJvKVxuICAgIC8vIDQuIHRoYXQgX21pZ2h0XyBidWJibGUgYWdhaW4gdG8gdGhlIGByZWFjdENvbnNvbGVFcnJvckhhbmRsZWAgZGVmaW5lZCBoZXJlXG4gICAgLy8gICAgLT4gc2hvdWxkIG5vdCBoYW5kbGUgZXhjZXB0aW9uIF9hZ2Fpbl8sIHRvIGF2b2lkIGxvb3BpbmcgLyBzaG93aW5nIHR3aWNlICh0aGlzIGNvZGUgYnJhbmNoKVxuICAgIC8vIDUuIHNob3VsZCBzdGlsbCBidWJibGUgdXAgdG8gb3JpZ2luYWwgY29uc29sZSAod2hpY2ggbWlnaHQgZWl0aGVyIGJlIGNvbnNvbGUubG9nLCBvciB0aGUgRGV2VG9vbHMgaGFuZGxlciBpbiBjYXNlIHRoYXQgb25lIHBhdGNoZWQgX2VhcmxpZXJfKVxuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmIChhcmd1bWVudHNbMF0gJiYgYXJndW1lbnRzWzBdLnN0YWNrKSB7XG4gICAgLy8gcmVwb3J0RXhjZXB0aW9uIHdpbGwgY29uc29sZS5lcnJvciB0aGlzIHdpdGggaGlnaCBlbm91Z2ggZmlkZWxpdHkuXG4gICAgcmVwb3J0RXhjZXB0aW9uKFxuICAgICAgYXJndW1lbnRzWzBdLFxuICAgICAgLyogaXNGYXRhbCAqLyBmYWxzZSxcbiAgICAgIC8qcmVwb3J0VG9Db25zb2xlKi8gZmFsc2UsXG4gICAgKTtcbiAgfSBlbHNlIHtcbiAgICBjb25zdCBzdHJpbmdpZnlTYWZlID0gcmVxdWlyZSgnLi4vVXRpbGl0aWVzL3N0cmluZ2lmeVNhZmUnKS5kZWZhdWx0O1xuICAgIGNvbnN0IHN0ciA9IEFycmF5LnByb3RvdHlwZS5tYXBcbiAgICAgIC5jYWxsKGFyZ3VtZW50cywgdmFsdWUgPT5cbiAgICAgICAgdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyA/IHZhbHVlIDogc3RyaW5naWZ5U2FmZSh2YWx1ZSksXG4gICAgICApXG4gICAgICAuam9pbignICcpO1xuXG4gICAgaWYgKHN0ci5zbGljZSgwLCA5KSA9PT0gJ1dhcm5pbmc6ICcpIHtcbiAgICAgIC8vIFJlYWN0IHdhcm5pbmdzIHVzZSBjb25zb2xlLmVycm9yIHNvIHRoYXQgYSBzdGFjayB0cmFjZSBpcyBzaG93biwgYnV0XG4gICAgICAvLyB3ZSBkb24ndCAoY3VycmVudGx5KSB3YW50IHRoZXNlIHRvIHNob3cgYSByZWRib3hcbiAgICAgIC8vIChOb3RlOiBMb2dpYyBkdXBsaWNhdGVkIGluIHBvbHlmaWxscy9jb25zb2xlLmpzLilcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgZXJyb3I6IEV4dGVuZGVkRXJyb3IgPSBuZXcgU3ludGhldGljRXJyb3Ioc3RyKTtcbiAgICBlcnJvci5uYW1lID0gJ2NvbnNvbGUuZXJyb3InO1xuICAgIHJlcG9ydEV4Y2VwdGlvbihlcnJvciwgLyogaXNGYXRhbCAqLyBmYWxzZSwgLypyZXBvcnRUb0NvbnNvbGUqLyBmYWxzZSk7XG4gIH1cbn1cblxuLyoqXG4gKiBTaG93cyBhIHJlZGJveCB3aXRoIHN0YWNrdHJhY2UgZm9yIGFsbCBjb25zb2xlLmVycm9yIG1lc3NhZ2VzLiAgRGlzYWJsZSBieVxuICogc2V0dGluZyBgY29uc29sZS5yZXBvcnRFcnJvcnNBc0V4Y2VwdGlvbnMgPSBmYWxzZTtgIGluIHlvdXIgYXBwLlxuICovXG5mdW5jdGlvbiBpbnN0YWxsQ29uc29sZUVycm9yUmVwb3J0ZXIoKSB7XG4gIC8vIEVuYWJsZSByZXBvcnRFcnJvcnNBc0V4Y2VwdGlvbnNcbiAgaWYgKGNvbnNvbGUuX2Vycm9yT3JpZ2luYWwpIHtcbiAgICByZXR1cm47IC8vIGFscmVhZHkgaW5zdGFsbGVkXG4gIH1cbiAgLy8gRmxvdyBkb2Vzbid0IGxpa2UgaXQgd2hlbiB5b3Ugc2V0IGFyYml0cmFyeSB2YWx1ZXMgb24gYSBnbG9iYWwgb2JqZWN0XG4gIGNvbnNvbGUuX2Vycm9yT3JpZ2luYWwgPSBjb25zb2xlLmVycm9yLmJpbmQoY29uc29sZSk7XG4gIGNvbnNvbGUuZXJyb3IgPSByZWFjdENvbnNvbGVFcnJvckhhbmRsZXI7XG4gIGlmIChjb25zb2xlLnJlcG9ydEVycm9yc0FzRXhjZXB0aW9ucyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgLy8gSW5kaXZpZHVhbCBhcHBzIGNhbiBkaXNhYmxlIHRoaXNcbiAgICAvLyBGbG93IGRvZXNuJ3QgbGlrZSBpdCB3aGVuIHlvdSBzZXQgYXJiaXRyYXJ5IHZhbHVlcyBvbiBhIGdsb2JhbCBvYmplY3RcbiAgICBjb25zb2xlLnJlcG9ydEVycm9yc0FzRXhjZXB0aW9ucyA9IHRydWU7XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIGhhbmRsZUV4Y2VwdGlvbixcbiAgaW5zdGFsbENvbnNvbGVFcnJvclJlcG9ydGVyLFxuICBTeW50aGV0aWNFcnJvcixcbiAgdW5zdGFibGVfc2V0RXhjZXB0aW9uRGVjb3JhdG9yLFxufTtcbiJdfQ==